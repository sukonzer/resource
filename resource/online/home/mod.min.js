!function(e){var t=t||{};t.debug=/localhost/.test(location.host),t.typeis=function(e){var t=Object.prototype.toString.call(e).slice(8,-1).toLocaleLowerCase();return void 0!==e&&null!==e&&t},t.extend=function(){var e=arguments,t=1===e.length?this:e[0],n=e.length>1?e[1]:e[0];if(null===n)return t;try{for(var r in n)if(!t.hasOwnProperty(n[r]))switch(this.typeis(t)){case"object":t[r]=n[r];break;case"function":t.prototype[r]=n[r]}return t}catch(a){}},t.extend({reg:{isInt:/^-?([1-9]\d*)?\d$/,isFloat:/^-?(([1-9]\d*)?\d(\.\d*)?|\.\d+)$/,isDate:/^(\d{4})-(\d{1,2})-(\d{1,2})$/,isDateTime:/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.\d+)?$/,toDate:/^(\d{4})-(\d{1,2})-(\d{1,2})( \d{1,2}:\d{1,2}:\d{1,2}(\.\d+)?)?$/,toDateTime:/^(\d{4})-(\d{1,2})-(\d{1,2})( (\d{1,2}):(\d{1,2}):(\d{1,2})(\.\d+)?)?$/,toFormatString:/([yMdhmsS])\1*/g},log:function(t,n,r){if(this.debug&&e.console)try{var a;1===arguments.length?a=t:arguments.length>=2&&(a="[ "+t+" ] "+n),r=r||"log",e.console[r]&&a&&e.console[r](a)}catch(i){}},getEvent:function(e){return e||window.event},getTarget:function(e){return e.target||e.srcElement},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},addHandler:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},removeHandler:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},charset:function(){var e=(document.charset||document.characterSet).toLowerCase();return"gbk"===e&&(e="gb2312"),e}(),browser:function(){var e,t;return e=function(){var e=navigator.userAgent.toLowerCase(),t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}(),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),t}(),getStyleName:function(){var e=["","-ms-","-moz-","-webkit-","-khtml-","-o-"],t=/-([a-z])/g;return function(n,r){r=r||document.documentElement;for(var a,i=r.style,o=0,c=e.length;c>o;o++)if(a=(e[o]+n).replace(t,function(e,t){return t.toLocaleUpperCase()}),a in i)return a;return null}}(),disableScroll:function(){function e(e){var e=e||window.event;t.preventDefault(e)}function n(e){for(var e=e||window.event,n=r.length;n--;)if(e.keyCode===r[n])return void t.preventDefault(e)}var r=[37,38,39,40];window.addEventListener&&window.addEventListener("DOMMouseScroll",e,!1),window.onmousewheel=document.onmousewheel=e,document.onkeydown=n},ableScroll:function(){function e(e){var e=e||window.event;t.preventDefault(e)}window.addEventListener&&window.addEventListener("DOMMouseScroll",e,!1),window.onmousewheel=document.onmousewheel=document.onkeydown=null},getClient:function(e){return e.pageX&&e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,y:e.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop}},fullScreen:{is:function(){return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen||document.msFullScreen||!1},enabled:function(){var e=document.documentElement;return"requestFullscreen"in e||"msRequestFullscreen"in e||"webkitRequestFullScreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||!1},toggle:function(){var e=document.documentElement;this.is()?document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},parseUrl:function(e){var t=document.createElement("a");return e=e||location.href,t.href=e,{source:e,protocol:t.protocol,host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n={},r=t.search.replace(/^\?/,"").split("&"),a=r.length,i=0;a>i;i++)r[i]&&(e=r[i].split("="),n[e[0]]=e[1]);return n}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash,path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},isLeapMonth:function(e){return e%100==0?e%400==0?1:0:e%4==0?1:0},toInt:function(e){return void 0===e||null===e?0:parseInt(e.replace(/,/g,""),10)},isDate:function(e){if("string"===this.typeis(e)){var t=e.match(this.reg.isDate);if(t){var n=this.toInt(t[1]),r=this.toInt(t[2])-1,a=this.toInt(t[3]),i=new Date(n,r,a);if(i.getFullYear()===n&&i.getMonth()===r&&i.getDate()===a)return!0}}return!1},isDateTime:function(e){if("string"===this.typeis(e)){var t=e.match(this.reg.isDateTime);if(t){var n=this.toInt(t[1]),r=this.toInt(t[2])-1,a=this.toInt(t[3]),i=this.toInt(t[4]||"")||0,o=this.toInt(t[5]||"")||0,c=this.toInt(t[6]||"")||0,s=new Date(n,r,a,i,o,c);if(s.getFullYear()===n&&s.getMonth()===r&&s.getDate()===a&&s.getHours()===i&&s.getMinutes()===o&&s.getSeconds()===c)return!0}}return!1},toFormatString:function(e,t){if(!(arguments.length<2)){var n={y:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),S:e.getMilliseconds()},r=function(e){var t=[];return t[e]="",t.join("0")},a={y:2};for(var i in n)!n.hasOwnProperty(i)||i in a||(a[i]=n[i].toString().length);return t.replace(this.reg.toFormatString,function(e,t){var i=n[t],o=Math.max(e.length,a[t]);return(r(o)+i).slice(-o)})}},calcTime:function(e){var t=new Date;return new Date(t.getTime()+6e4*t.getTimezoneOffset()+36e5*e)},replaceAll:function(e,t){return e.replace(/\$\{(\w+)\}/g,function(e,n){return n in t?t[n]:e})}}),e.online=t}(window),function(e,t){var n={tmplMapString:/[\r\n\'\"\\]/g,tmplCheckVari:/(^|[^\.])\b([a-z_$][\w$]*)/gi,tmplParse:/^[\s\S]*?(?=(\$\{|\{\{))/,tmplKey_$:/^\$\{([\s\S]+)\}$/,tmplKey_cmd:/^\{\{\s*(if|else|\/if|\/?loop|\/?each|\/?enum|tmpl)\b.*\}\}$/,tmplKey_if:/^\{\{\s*if\s+(.+?)\s*\}\}$/,tmplKey_else:/^\{\{\s*else(\s+(.+?))?\s*\}\}$/,tmplKey_loop:/^\{\{\s*loop(\s*\(([^,\)]+)(,([^,\)]+))?\))?\s+(.+?)\s*\}\}$/,tmplKey_each:/^\{\{\s*each(\s*\(([^,\)]+)(,([^,\)]+))?(,([^,\)]+))?\))?\s+(.+?)\s*\}\}$/,tmplKey_enum:/^\{\{\s*enum(\s*\(([^,\)]+)(,([^,\)]+))?\))?\s+(.+?)\s*\}\}$/,tmplKey_tmpl:/^\{\{\s*tmpl\s+(.+?)(,([^,]+?))?\s*\}\}$/};e.tmpl={_tmpls:{},_keyword1:["break","delete","function","return","typeof","case","do","if","switch","var","catch","else","in","this","void","continue","false","instanceof","throw","while","debugger","finally","new","true","with","default","for","null","try"],_keyword2:["abstract","double","goto","native","static","boolean","enum","implements","package","super","byte","export","import","private","synchronized","char","extends","int","protected","throws","class","final","interface","public","transient","const","float","long","short","volatile"],_keywordHash:null,_stringMap:{"\r":"\\r","\n":"\\n",'"':'\\"',"'":"\\'","\\":"\\\\"},_init:function(){if(!this._keywordHash){this._keywordHash={};for(var e=0,t=this._keyword1.length;t>e;e++)this._keywordHash[this._keyword1[e]]=!0;for(var e=0,t=this._keyword2.length;t>e;e++)this._keywordHash[this._keyword2[e]]=!0}},_mapString:function(e){var t=this._stringMap;return e.replace(n.tmplMapString,function(e){return t[e]||e})},_parse:function(e){var t,r=[],a=0;e:for(;;){if(t="",e=e.replace(n.tmplParse,function(e,n){return r[a++]={type:"txt",value:e},t=n,""}),!t){r[a++]={type:"txt",value:e};break e}t:if("${"==t){for(var i=1,o=2,c=e.length;c>o;o++){var s=e.substr(o,1);switch(s){case"{":i++;break;case"}":i--}if(!i){r[a++]={type:"vari",value:e.slice(0,o+1)},e=e.slice(o+1);break t}}r[a++]={type:"txt",value:e};break e}t:if("{{"==t){for(var i=2,o=2,c=e.length;c>o;o++){var s=e.substr(o,1);switch(s){case"{":i++;break;case"}":i--}if(!i){r[a++]={type:"}"==e.substr(o-1,1)?"cmd":"txt",value:e.slice(0,o+1)},e=e.slice(o+1);break t}}r[a++]={type:"txt",value:e};break e}}return r},_checkVari:function(){for(var e,t=[],r=0,a=this._keywordHash,i=0,o=arguments.length;o>i;i++)e=arguments[i],e.replace(n.tmplCheckVari,function(e,n,i){a.hasOwnProperty(i)||(t[r++]="if (typeof "+i+'=="undefined") _undefined["'+i+'"]="";')});return t.join("")},_splitVari:function(e){for(var t=[],n=0,r=(e+" ,").split(""),a=[],i=0,o=0,c=r.length;c>o;o++)if('"'!=a[0]&&"'"!=a[0]||"\\"!=r[o])switch(r[o]){case",":a.length||(t[n++]=e.slice(i,o).trim(),i=o+1);break;case"(":case"[":case"{":a.unshift(r[o]);break;case")":"("==a[0]&&a.shift();break;case"]":"["==a[0]&&a.shift();break;case"}":"{"==a[0]&&a.shift();break;case'"':case"'":a[0]==r[o]?a.shift():a.unshift(r[o])}else o++;return t},repeat:function(e,t){var n=[];return n[t]="",n.join(e)},_makeFn:function(r){var a=[],i=0,o=[],c=0;o[c++]="var _o=[],_k=0,_undefined={};if(!$data){$data={};}if(!$opt){$opt={};}with(_undefined){with($opt){with($data){";for(var s='_undefined["#tmp"]',l=0,u=r.length;u>l;l++)switch(r[l].type){case"txt":o[c++]='_o[_k++]="'+this._mapString(r[l].value)+'";';break;case"vari":var m=r[l].value.match(n.tmplKey_$),h=this._checkVari(m[1]);o[c++]=h+"_o[_k++]="+m[1]+";";break;case"cmd":var f=r[l].value.match(n.tmplKey_cmd);if(!f)break;switch(f[1]){case"if":var d=r[l].value.match(n.tmplKey_if);a[++i]=1;var h=this._checkVari(d[1]);o[c++]=h+"try{"+s+"="+d[1]+";}catch($error){"+s+"=false;};if ("+s+"){";break;case"else":var d=r[l].value.match(n.tmplKey_else);if(d[1]){a[i]++;var h=this._checkVari(d[2]);o[c++]="}else{"+h+"try{"+s+"="+d[2]+";}catch($error){"+s+"=false;};if ("+s+"){"}else o[c++]="}else{";break;case"/if":o[c++]=e.tmpl.repeat("}",a[i--]);break;case"loop":var d=r[l].value.match(n.tmplKey_loop),p=d[2]||"$index",v=d[4]||"$length",g=d[5],h=this._checkVari(g);switch(g=this._splitVari(g),g.length){case 1:g=[0,g[0],1];break;case 2:g=[g[0],g[1],1]}var k;switch(g[2]){case 0:g[2]="",k="<";break;case 1:g[2]="++",k="<";break;case-1:g[2]="--",k="<";break;default:if(g[2].toString().isFloat()){var w=parseFloat(g[2],10);k=w>=0?"<":">",g[2]="+="+g[2]}}o[c++]=k?h+"(function(){for (var "+p+"="+g[0]+","+v+"="+g[1]+";"+p+k+v+";"+p+g[2]+"){":h+"(function(){for (var "+p+"="+g[0]+","+v+"="+g[1]+",$step="+g[2]+";$step>=0^"+p+"<"+v+";"+p+"+=$step){";break;case"/loop":o[c++]="}})();";break;case"each":var d=r[l].value.match(n.tmplKey_each),p=d[2]||"$index",_=d[4]||"$value",v=d[6]||"$length",g=d[7],h=this._checkVari(g);o[c++]=h+"(function(){for (var "+p+"=0,"+v+"=("+g+").length;"+p+"<"+v+";"+p+"++){var "+_+"="+g+"["+p+"];with("+_+"){";break;case"/each":o[c++]="}}})();";break;case"enum":var d=r[l].value.match(n.tmplKey_enum),b=d[2]||"$key",_=d[4]||"$value",g=d[5],h=this._checkVari(g);o[c++]=h+"(function(){for (var "+b+" in "+g+"){var "+_+"="+g+"["+b+"];with("+_+"){";break;case"/enum":o[c++]="}}})();";break;case"tmpl":var d=r[l].value.match(n.tmplKey_tmpl);d[3]=d[3]||"$data";var h=this._checkVari(d[1],d[3]);o[c++]=h+"_o[_k++]=$.tmpl.render("+d[1]+","+d[3]+");"}}o[c++]='}}} return _o.join("");';var y=o.join("");try{var $=new Function("$data","$opt",y)}catch(S){return t.log("tmpl._makefn","invalid source"),t.log(S),e.log("tmpl._makefn",y),e.COMMON_DONOTHING}return $},_makeFnStrict:function(r){var a=[],i=0,o=[],c=0;o[c++]="\r\n			var _o=[],_k=0;\r\n			if (!$data){\r\n				$data={};\r\n			}\r\n			if (!$opt){\r\n				$opt={};\r\n			}\r\n		";for(var s=0,l=r.length;l>s;s++)switch(r[s].type){case"txt":o[c++]='_o[_k++]="'+this._mapString(r[s].value)+'";';break;case"vari":var u=r[s].value.match(n.tmplKey_$);o[c++]="_o[_k++]="+u[1]+";";break;case"cmd":var m=r[s].value.match(n.tmplKey_cmd);if(!m)break;switch(m[1]){case"if":var h=r[s].value.match(n.tmplKey_if);a[++i]=1,o[c++]="if ("+h[1]+"){";break;case"else":var h=r[s].value.match(n.tmplKey_else);h[1]?(a[i]++,o[c++]="}else{ if ("+h[2]+"){"):o[c++]="}else{";break;case"/if":o[c++]=e.tmpl.repeat("}",a[i--]);break;case"loop":var h=r[s].value.match(n.tmplKey_loop),f=h[2]||"$index",d=h[4]||"$length",p=h[5];switch(p=this._splitVari(p),p.length){case 1:p=[0,p[0],1];case 2:p=[p[0],p[1],1]}var v;switch(p[2]){case 0:p[2]="",v="<";break;case 1:p[2]="++",v="<";break;case-1:p[2]="--",v="<";break;default:if(p[2].toString().isFloat()){var g=parseFloat(p[2],10);v=g>=0?"<":">",p[2]="+="+p[2]}}o[c++]=v?"(function(){for (var "+f+"="+p[0]+","+d+"="+p[1]+";"+f+v+d+";"+f+p[2]+"){":"(function(){for (var "+f+"="+p[0]+","+d+"="+p[1]+",$step="+p[2]+";$step>=0^"+f+"<"+d+";"+f+"+=$step){";break;case"/loop":o[c++]="}})();";break;case"each":var h=r[s].value.match(n.tmplKey_each),f=h[2]||"$index",k=h[4]||"$value",d=h[6]||"$length",p=h[7];o[c++]="(function(){for (var "+f+"=0,"+d+"=("+p+").length;"+f+"<"+d+";"+f+"++){var "+k+"="+p+"["+f+"];";break;case"/each":o[c++]="}})();";break;case"enum":var h=r[s].value.match(n.tmplKey_enum),w=h[2]||"$key",k=h[4]||"$value",p=h[5];o[c++]="(function(){for (var "+w+" in "+p+"){var "+k+"="+p+"["+w+"];";break;case"/enum":o[c++]="}})();";break;case"tmpl":var h=r[s].value.match(n.tmplKey_tmpl);h[3]=h[3]||"$data",o[c++]="_o[_k++]=$.tmpl.renderStrict("+h[1]+","+h[3]+");"}}o[c++]='return _o.join("");';var _=o.join("");try{var b=new Function("$data","$opt",_)}catch(y){return t.log("tmpl._makeFnStrict","invalid source"),t.log(y),e.log("tmpl._makeFnStrict",_),e.COMMON_DONOTHING}return b},_getCache:function(e){var t=this._tmpls[e];return t||(t=this._tmpls[e]={source:e}),t.tmpl||(t.tmpl=this._parse(e)),t},render:function(e,n,r){this._init();var a=this._getCache(e);a.fn||(a.fn=this._makeFn(a.tmpl));try{var i=a.fn(n||{},r||{})}catch(o){return t.log("tmpl.render",a.fn.toString().slice(0,200)+"..."),""}return i},renderStrict:function(e,n,r){this._init();var a=this._getCache(e);a.fnStrict||(a.fnStrict=this._makeFnStrict(a.tmpl));try{var i=a.fnStrict(n||{},r||{})}catch(o){return t.log("tmpl.renderStrict",a.fnStrict.toString().slice(0,200)+"..."),""}return i}}}(window.jQuery||window.Zepto,online);